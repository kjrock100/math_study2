# 16.3 심화 망원 급수 (Telescoping Sums)

## 1. 개요 (Overview)

기초적인 망원 급수가 이웃한 항($k$와 $k+1$)끼리 바로 지워지는 형태였다면, 심화 과정에서는 **두 칸 이상 건너뛰어 소거**되거나, 덧셈이 아닌 **곱셈 형태(Product)**로 소거되는 유형을 다룹니다. 이러한 패턴을 파악하면 복잡해 보이는 식을 매우 간단하게 정리할 수 있습니다.

## 2. 주요 심화 유형 (Advanced Types)

### 2.1 건너뛰는 소거 (Gap Telescoping)

부분분수 분해 시 분모의 차이가 1보다 큰 경우입니다.
$$ \frac{1}{k(k+2)} = \frac{1}{2} \left( \frac{1}{k} - \frac{1}{k+2} \right) $$

- 이 경우 바로 옆 항과 지워지지 않고, **앞에서 2개, 뒤에서 2개**의 항이 남게 됩니다.

### 2.2 망원 곱 (Telescoping Products)

항들이 곱셈으로 연결되어 분모와 분자가 약분되는 형태입니다.
$$ \prod*{k=2}^n \left(1 - \frac{1}{k^2}\right) = \prod*{k=2}^n \frac{(k-1)(k+1)}{k^2} $$

- $\frac{k-1}{k}$ 부분과 $\frac{k+1}{k}$ 부분으로 나누어 보면 규칙적인 약분이 일어납니다.

### 2.3 팩토리얼 급수 (Factorial Series)

팩토리얼을 포함한 급수에서 자주 쓰이는 항등식입니다.
$$ k \cdot k! = (k+1 - 1) k! = (k+1)! - k! $$

- 이를 이용하면 $\sum k \cdot k!$ 형태를 망원 급수로 변형할 수 있습니다.

## 3. 예제 (Examples)

### 예제 1: 두 칸 건너뛰기

$$ S = \sum\_{k=1}^{10} \frac{1}{k(k+2)} $$

- 변형: $\frac{1}{2} \sum (\frac{1}{k} - \frac{1}{k+2})$
- 나열:
  $$ \frac{1}{2} \left[ (1 - \frac{1}{3}) + (\frac{1}{2} - \frac{1}{4}) + (\frac{1}{3} - \frac{1}{5}) + \dots + (\frac{1}{10} - \frac{1}{12}) \right] $$
- 소거: $-\frac{1}{3}$과 $+\frac{1}{3}$부터 지워지기 시작합니다.
- 남는 항: 앞의 $(1 + \frac{1}{2})$과 뒤의 $(-\frac{1}{11} - \frac{1}{12})$.
- 계산: $\frac{1}{2} (\frac{3}{2} - \frac{23}{132}) = \frac{1}{2} (\frac{198 - 23}{132}) = \frac{175}{264}$.

### 예제 2: 망원 곱

$$ P = \prod\_{k=2}^{10} \left(1 - \frac{1}{k^2}\right) $$

- 변형: $\prod \frac{k-1}{k} \cdot \frac{k+1}{k}$
- 나열:
  $$ \left(\frac{1}{2} \cdot \frac{3}{2}\right) \times \left(\frac{2}{3} \cdot \frac{4}{3}\right) \times \dots \times \left(\frac{9}{10} \cdot \frac{11}{10}\right) $$
- 재배열: $(\frac{1}{2} \cdot \frac{2}{3} \cdot \dots \cdot \frac{9}{10}) \times (\frac{3}{2} \cdot \frac{4}{3} \cdot \dots \cdot \frac{11}{10})$
- 약분: 앞부분은 $\frac{1}{10}$, 뒷부분은 $\frac{11}{2}$.
- 결과: $\frac{1}{10} \times \frac{11}{2} = \frac{11}{20}$.
- 일반화 공식: $\frac{n+1}{2n}$.

### 예제 3: 팩토리얼 합

$$ S = \sum\_{k=1}^{5} k \cdot k! $$

- 변형: $\sum ((k+1)! - k!)$
- 나열: $(2! - 1!) + (3! - 2!) + \dots + (6! - 5!)$
- 결과: $6! - 1! = 720 - 1 = 719$.

## 4. 코드 구현 (Code Implementation)

Python을 사용하여 심화 망원 급수 및 곱을 계산하는 함수입니다.

```python
import math

def solve_gap_telescoping(n):
    """
    Sum of 1/(k(k+2)) from k=1 to n
    Formula: 1/2 * (1 + 1/2 - 1/(n+1) - 1/(n+2))
    """
    return 0.5 * (1 + 0.5 - 1/(n + 1) - 1/(n + 2))

def solve_telescoping_product(n):
    """
    Product of (1 - 1/k^2) from k=2 to n
    Formula: (n+1) / (2n)
    """
    return (n + 1) / (2 * n)

def solve_factorial_sum(n):
    """
    Sum of k * k! from k=1 to n
    Formula: (n+1)! - 1
    """
    return math.factorial(n + 1) - 1

# 테스트
print(f"Gap Sum (n=10): {solve_gap_telescoping(10):.5f}")       # Expected: 175/264 approx 0.66288
print(f"Product (n=10): {solve_telescoping_product(10)}")      # Expected: 11/20 = 0.55
print(f"Factorial Sum (n=5): {solve_factorial_sum(5)}")        # Expected: 719
```

## 5. 요약 (Summary)

- **건너뛰는 소거:** 분모 차이가 $d$이면 $\frac{1}{d}$로 묶고, 앞뒤로 $d$개씩 항이 남습니다.
- **망원 곱:** $1 - \frac{1}{k^2}$ 형태는 합차 공식으로 인수분해하여 약분합니다.
- **팩토리얼:** $k \cdot k! = (k+1)! - k!$ 변형을 기억하세요.
