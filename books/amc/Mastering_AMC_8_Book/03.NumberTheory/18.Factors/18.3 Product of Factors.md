# 18.3 약수의 곱 (Product of Factors)

## 1. 개요 (Overview)

약수의 곱(Product of Factors)은 어떤 자연수의 모든 양의 약수를 곱한 값을 말합니다. 약수의 개수 공식을 활용하여 간단하게 계산할 수 있으며, 약수들이 짝을 이루는 대칭성을 이해하는 것이 핵심입니다.

## 2. 공식 및 원리 (Formula & Principle)

### 2.1 공식

자연수 $N$의 약수의 개수를 $d(N)$이라고 할 때, 모든 약수의 곱 $P(N)$은 다음과 같습니다.

$$ P(N) = N^{\frac{d(N)}{2}} = \sqrt{N^{d(N)}} $$

### 2.2 원리 (Why?)

약수들은 보통 곱해서 $N$이 되는 짝(Pair)을 이룹니다.

- 예를 들어 $N=12$의 약수는 $1, 2, 3, 4, 6, 12$입니다.
  - $1 \times 12 = 12$
  - $2 \times 6 = 12$
  - $3 \times 4 = 12$
- 약수의 개수가 $d(N)$개라면, 이러한 쌍은 총 $\frac{d(N)}{2}$쌍이 존재합니다.
- 따라서 총곱은 $N$을 $\frac{d(N)}{2}$번 곱한 것과 같습니다.

### 2.3 완전제곱수의 경우

완전제곱수는 약수의 개수 $d(N)$이 홀수입니다. 이 경우 정중앙에 있는 약수($\sqrt{N}$)는 짝이 없이 혼자 남습니다.

- 쌍의 개수: $\frac{d(N)-1}{2}$개.
- 총곱: $N^{\frac{d(N)-1}{2}} \times \sqrt{N} = N^{\frac{d(N)}{2} - \frac{1}{2}} \times N^{\frac{1}{2}} = N^{\frac{d(N)}{2}}$.
- 결국 공식은 동일하게 적용됩니다.

## 3. 예제 (Examples)

### 예제 1: 일반적인 수

$12$의 모든 약수의 곱은?

- 약수의 개수 $d(12)$: $12 = 2^2 \times 3^1 \rightarrow (2+1)(1+1) = 6$개.
- 공식 적용: $12^{6/2} = 12^3 = 1728$.

### 예제 2: 완전제곱수

$36$의 모든 약수의 곱은?

- 약수의 개수 $d(36)$: $36 = 2^2 \times 3^2 \rightarrow (2+1)(2+1) = 9$개.
- 공식 적용: $36^{9/2} = (\sqrt{36})^9 = 6^9 = 10,077,696$.
- 검증: $1, 2, 3, 4, 6, 9, 12, 18, 36$.
  - $(1,36), (2,18), (3,12), (4,9)$ $\rightarrow 36^4$.
  - 가운데 $6$.
  - 총곱 $36^4 \times 6 = (6^2)^4 \times 6 = 6^9$.

## 4. 코드 구현 (Code Implementation)

Python을 사용하여 약수의 개수를 먼저 구한 뒤, 공식을 이용해 약수의 곱을 계산하는 함수입니다.

```python
def get_divisor_count(n):
    """약수의 개수 구하기"""
    count = 0
    for i in range(1, int(n**0.5) + 1):
        if n % i == 0:
            count += 1
            if i * i != n:
                count += 1
    return count

def product_of_factors(n):
    """
    약수의 곱 구하기: N^(d(N)/2)
    """
    d_n = get_divisor_count(n)

    # 지수가 정수가 되도록 처리 (부동소수점 오차 방지)
    if d_n % 2 == 0:
        # 약수 개수가 짝수면 지수는 정수
        return n ** (d_n // 2)
    else:
        # 약수 개수가 홀수면 n은 완전제곱수 -> sqrt(n)은 정수
        sqrt_n = int(n**0.5)
        return sqrt_n ** d_n

# 테스트
print(f"Product of factors of 12: {product_of_factors(12)}") # Expected: 1728
print(f"Product of factors of 36: {product_of_factors(36)}") # Expected: 6^9 = 10077696

# 검증 (Brute Force)
def brute_force_product(n):
    p = 1
    for i in range(1, n + 1):
        if n % i == 0: p *= i
    return p

print(f"Verification for 12: {brute_force_product(12)}")
```

## 5. 요약 (Summary)

- **공식:** $P(N) = N^{d(N)/2}$.
- **의미:** $N$을 약수 쌍의 개수만큼 곱한 것.
- **완전제곱수:** $\sqrt{N}$을 약수의 개수만큼 곱한 것과 같다 ($(\sqrt{N})^{d(N)}$).
