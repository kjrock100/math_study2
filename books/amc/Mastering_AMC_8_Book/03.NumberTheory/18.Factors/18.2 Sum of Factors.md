# 18.2 약수의 합 (Sum of Factors)

## 1. 개요 (Overview)

약수의 합(Sum of Divisors)은 어떤 자연수의 모든 양의 약수를 더한 값을 말합니다. 기호로는 $\sigma(N)$으로 표기하며, 완전수(Perfect Number)나 친화수(Amicable Numbers) 등을 정의하는 데 사용되는 중요한 개념입니다.

## 2. 공식 및 원리 (Formula & Principle)

### 2.1 공식

자연수 $N$을 소인수분해하여 $N = p_1^{e_1} \times p_2^{e_2} \times \dots \times p_k^{e_k}$ 꼴로 나타냈을 때, 약수의 합 $\sigma(N)$은 다음과 같습니다.

$$ \sigma(N) = \left( \frac{p_1^{e_1+1}-1}{p_1-1} \right) \times \left( \frac{p_2^{e_2+1}-1}{p_2-1} \right) \times \dots \times \left( \frac{p_k^{e_k+1}-1}{p_k-1} \right) $$

이는 각 소인수별 등비수열의 합을 모두 곱한 것과 같습니다.
$$ (1 + p_1 + p_1^2 + \dots + p_1^{e_1}) \times (1 + p_2 + \dots + p_2^{e_2}) \times \dots $$

### 2.2 원리 (Why?)

약수는 각 소인수 $p_i$를 $0$개부터 $e_i$개까지 선택하여 곱한 형태입니다. 위 식을 전개(Expand)하면 분배 법칙에 의해 가능한 모든 소인수 조합의 곱, 즉 모든 약수들의 합이 나옵니다.

## 3. 예제 (Examples)

### 예제 1: 약수의 합 구하기

$12$의 약수의 합은?

- 소인수분해: $12 = 2^2 \times 3^1$.
- 공식 적용:
  - $2$ 부분: $1 + 2 + 2^2 = 7$ (또는 $\frac{2^3-1}{2-1} = 7$)
  - $3$ 부분: $1 + 3 = 4$ (또는 $\frac{3^2-1}{3-1} = 4$)
- 결과: $7 \times 4 = 28$.
- 검증: $1, 2, 3, 4, 6, 12$의 합은 $28$.

### 예제 2: 72의 약수의 합

- $72 = 2^3 \times 3^2$.
- $2$ 부분: $\frac{2^4-1}{2-1} = 15$.
- $3$ 부분: $\frac{3^3-1}{3-1} = \frac{26}{2} = 13$.
- 결과: $15 \times 13 = 195$.

## 4. 코드 구현 (Code Implementation)

Python을 사용하여 소인수분해를 통해 약수의 합을 계산하는 함수입니다.

```python
def sum_of_factors(n):
    """
    약수의 합을 구하는 함수
    """
    if n == 1: return 1

    total_sum = 1
    d = 2
    temp = n

    while d * d <= temp:
        if temp % d == 0:
            current_sum = 1
            p_pow = 1
            while temp % d == 0:
                p_pow *= d
                current_sum += p_pow
                temp //= d
            total_sum *= current_sum
        d += 1

    if temp > 1:
        total_sum *= (1 + temp)

    return total_sum

# 테스트
print(f"Sum of factors of 12: {sum_of_factors(12)}") # Expected: 28
print(f"Sum of factors of 72: {sum_of_factors(72)}") # Expected: 195
print(f"Sum of factors of 28 (Perfect Number): {sum_of_factors(28)}") # Expected: 1+2+4+7+14+28 = 56 = 2*28
```

## 5. 요약 (Summary)

- **공식:** 각 소인수의 거듭제곱 합($1+p+\dots+p^e$)을 곱한다.
- **등비수열 합:** $\frac{p^{e+1}-1}{p-1}$ 공식을 활용하면 계산이 빠르다.
- **완전수:** 자기 자신을 제외한 약수의 합이 자기 자신과 같은 수 (즉, 약수의 총합이 $2N$).
