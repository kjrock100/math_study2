# 20.7 부정방정식 (Diophantine Equations)

## 1. 개요 (Overview)

부정방정식(Diophantine Equation)은 해가 **정수(Integer)**인 방정식을 말합니다. 미지수의 개수가 방정식의 개수보다 많아 해가 무수히 많을 수 있지만, '정수 해'라는 조건 때문에 해가 제한되거나 특정한 형태(일반해)를 띠게 됩니다. AMC 8에서는 주로 일차 부정방정식($ax + by = c$)과 관련된 문제가 출제됩니다.

## 2. 선형 부정방정식 (Linear Diophantine Equations)

### 2.1 해의 존재 조건 (Existence of Solutions)

방정식 $ax + by = c$가 정수 해를 가지려면, $a$와 $b$의 최대공약수 $d = GCD(a, b)$가 $c$를 나누어야 합니다.
$$ d \mid c $$
만약 $c$가 $d$의 배수가 아니라면, 정수 해는 존재하지 않습니다.

### 2.2 일반해 (General Solution)

특수 해 $(x_0, y_0)$를 하나 찾았다면, 일반해는 다음과 같습니다. (단, $d = GCD(a, b)$)
$$ x = x_0 + \frac{b}{d}k $$
$$ y = y_0 - \frac{a}{d}k $$
($k$는 임의의 정수)

## 3. 치킨 맥너겟 정리 (Chicken McNugget Theorem)

서로소인 두 양의 정수 $a, b$에 대하여, $ax + by$ ($x, y \ge 0$) 꼴로 나타낼 수 **없는** 가장 큰 정수는 다음과 같습니다.
$$ ab - a - b $$
이 정리는 동전 문제(Coin Problem)나 우표 문제에서 자주 사용됩니다.

## 4. 예제 (Examples)

### 예제 1: 해 구하기

$3x + 5y = 1$의 정수 해를 구하시오.

- $GCD(3, 5) = 1$이고, 1은 1을 나누므로 해가 존재합니다.
- 확장 유클리드 호제법 또는 대입:
  - $5 = 1 \times 3 + 2$
  - $3 = 1 \times 2 + 1$
  - $1 = 3 - 2 = 3 - (5 - 3) = 2 \times 3 - 1 \times 5$.
- 즉, $3(2) + 5(-1) = 1$.
- 특수 해: $x_0 = 2, y_0 = -1$.
- 일반 해: $x = 2 + 5k, y = -1 - 3k$.

### 예제 2: 맥너겟 정리

6개들이 박스와 7개들이 박스로 너겟을 판다. 살 수 없는 가장 큰 너겟의 개수는?

- $GCD(6, 7) = 1$ (서로소).
- 공식 적용: $6 \times 7 - 6 - 7 = 42 - 13 = 29$.
- **정답:** 29개.

## 5. 코드 구현 (Code Implementation)

Python을 사용하여 확장 유클리드 호제법으로 부정방정식의 해를 구하고, 맥너겟 정리를 계산하는 함수입니다.

```python
def extended_gcd(a, b):
    """확장 유클리드 호제법: ax + by = gcd(a, b)의 해 반환"""
    if a == 0:
        return b, 0, 1
    else:
        g, y, x = extended_gcd(b % a, a)
        return g, x - (b // a) * y, y

def solve_linear_diophantine(a, b, c):
    """
    ax + by = c 의 특수 해 (x, y) 찾기
    """
    g, x0, y0 = extended_gcd(abs(a), abs(b))

    if c % g != 0:
        return None # 해 없음

    # 특수 해 스케일링
    x = x0 * (c // g)
    y = y0 * (c // g)

    # 입력 a, b의 부호에 따른 조정
    if a < 0: x = -x
    if b < 0: y = -y

    return x, y

def mcnugget_limit(a, b):
    """ax + by로 표현할 수 없는 가장 큰 수 (a, b 서로소)"""
    import math
    if math.gcd(a, b) != 1:
        return None # 서로소가 아니면 무한히 많음
    return a * b - a - b

# 테스트
a, b, c = 3, 5, 1
sol = solve_linear_diophantine(a, b, c)
print(f"Solution for {a}x + {b}y = {c}: x={sol[0]}, y={sol[1]}")
# 검증: 3(2) + 5(-1) = 6 - 5 = 1 (OK)

print(f"Largest impossible sum for 6, 7: {mcnugget_limit(6, 7)}") # Expected: 29
```

## 6. 요약 (Summary)

- **조건:** $GCD(a, b)$가 $c$를 나누어야 함.
- **해법:** 확장 유클리드 호제법으로 특수 해를 찾고, $k$를 이용해 일반 해를 표현.
- **맥너겟 정리:** $ab - a - b$ (서로소일 때).
- **활용:** 정수 조건이 있는 문장제 문제 해결.
