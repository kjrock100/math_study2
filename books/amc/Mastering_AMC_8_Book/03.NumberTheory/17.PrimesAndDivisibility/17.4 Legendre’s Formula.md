# 17.4 르장드르 공식 (Legendre’s Formula)

## 1. 개요 (Overview)

르장드르 공식(Legendre’s Formula)은 팩토리얼 $n!$을 소인수분해했을 때, 특정 소수 $p$가 몇 번 곱해져 있는지(지수)를 구하는 공식입니다. AMC 8에서 **"$n!$의 끝에 있는 0의 개수는?"** 이라는 질문으로 매우 자주 등장하는 핵심 주제입니다.

## 2. 공식 및 원리 (Formula & Principle)

### 2.1 공식

$n!$의 소인수분해에서 소수 $p$의 지수 $E_p(n!)$은 다음과 같습니다.

$$ E_p(n!) = \left\lfloor \frac{n}{p} \right\rfloor + \left\lfloor \frac{n}{p^2} \right\rfloor + \left\lfloor \frac{n}{p^3} \right\rfloor + \dots $$

- $\lfloor x \rfloor$: $x$를 넘지 않는 최대 정수 (내림, Floor Function).
- 합은 $p^k > n$이 되어 항이 0이 될 때까지 계속합니다.

### 2.2 원리 이해

왜 단순히 $\lfloor \frac{n}{p} \rfloor$가 아닐까요?

- $\lfloor \frac{n}{p} \rfloor$: $p$의 배수의 개수를 셉니다. (소인수 $p$를 최소 1개 가진 수들)
- $\lfloor \frac{n}{p^2} \rfloor$: $p^2$의 배수의 개수를 셉니다. 이들은 소인수 $p$를 2개 가지고 있는데, 첫 번째 항에서 한 번만 세어졌으므로 여기서 한 번 더 세어줍니다.
- 이 과정을 반복하여 모든 소인수 $p$의 개수를 빠짐없이 더하는 원리입니다.

## 3. 주요 응용: 끝자리 0의 개수 (Trailing Zeros)

$n!$의 끝에 있는 0의 개수는 $n!$이 $10$으로 몇 번 나누어 떨어지는지와 같습니다.

- $10 = 2 \times 5$.
- 소인수분해 시 $2$의 개수는 $5$의 개수보다 항상 많습니다.
- 따라서, **$10$의 개수는 소인수 $5$의 개수($E_5(n!)$)에 의해 결정**됩니다.

$$ \text{Trailing Zeros} = \sum\_{k=1}^{\infty} \left\lfloor \frac{n}{5^k} \right\rfloor = \left\lfloor \frac{n}{5} \right\rfloor + \left\lfloor \frac{n}{25} \right\rfloor + \left\lfloor \frac{n}{125} \right\rfloor + \dots $$

## 4. 예제 (Examples)

### 예제 1: 소인수의 지수 구하기

$10!$을 소인수분해했을 때 $2$의 지수는?

- $\lfloor \frac{10}{2} \rfloor = 5$ (2, 4, 6, 8, 10)
- $\lfloor \frac{10}{4} \rfloor = 2$ (4, 8)
- $\lfloor \frac{10}{8} \rfloor = 1$ (8)
- $\lfloor \frac{10}{16} \rfloor = 0$
- **합:** $5 + 2 + 1 = 8$.
- 즉, $10! = 2^8 \times \dots$

### 예제 2: 끝자리 0의 개수

$100!$의 끝에는 0이 몇 개 있는가?

- 소인수 5의 개수를 구합니다.
- $\lfloor \frac{100}{5} \rfloor = 20$
- $\lfloor \frac{100}{25} \rfloor = 4$
- $\lfloor \frac{100}{125} \rfloor = 0$
- **합:** $20 + 4 = 24$개.

### 예제 3: 복합 문제

$50!$은 $12^k$로 나누어 떨어진다. 가능한 가장 큰 정수 $k$는?

- $12 = 2^2 \times 3$.
- 소인수 2의 개수: $25 + 12 + 6 + 3 + 1 = 47$. $2^2$이 필요하므로 $47 \div 2 = 23$세트 가능.
- 소인수 3의 개수: $\lfloor \frac{50}{3} \rfloor + \lfloor \frac{50}{9} \rfloor + \lfloor \frac{50}{27} \rfloor = 16 + 5 + 1 = 22$.
- $2^2$ 세트는 23개, $3$은 22개 있으므로, $12$는 최대 **22번** 만들 수 있음.
- **정답:** $k=22$.

## 5. 코드 구현 (Code Implementation)

Python을 사용하여 르장드르 공식을 구현하고, 팩토리얼의 끝자리 0의 개수를 계산하는 함수입니다.

```python
def legendre_formula(n, p):
    """
    n!의 소인수분해에서 소수 p의 지수를 계산
    """
    count = 0
    divisor = p
    while divisor <= n:
        count += n // divisor
        divisor *= p
    return count

def count_trailing_zeros(n):
    """
    n!의 끝자리 0의 개수 계산 (소인수 5의 개수)
    """
    return legendre_formula(n, 5)

# 테스트
print(f"Exponent of 2 in 10!: {legendre_formula(10, 2)}")       # Expected: 8
print(f"Trailing zeros in 100!: {count_trailing_zeros(100)}")   # Expected: 24
print(f"Exponent of 3 in 50!: {legendre_formula(50, 3)}")       # Expected: 22
```

## 6. 요약 (Summary)

- **공식:** $E_p(n!) = \lfloor n/p \rfloor + \lfloor n/p^2 \rfloor + \dots$
- **Trailing Zeros:** $n!$의 0의 개수는 **5의 지수**를 구하면 된다.
