# 9.2 격자 속 정사각형의 개수 (Number of Squares in Grid)

## 1. 개요 (Overview)

격자(Grid) 안에서 찾을 수 있는 정사각형의 개수를 세는 문제입니다. 직사각형 개수 세기와 달리, 가로와 세로의 길이가 같아야 한다는 제약 조건이 있으므로 **크기(Size)별로 케이스를 나누어** 세는 것이 기본 전략입니다.

## 2. 정사각형 격자 ($n \times n$ Grid)

가로와 세로 칸 수가 같은 $n \times n$ 격자에서 정사각형의 총 개수는 제곱수의 합과 같습니다.

### 2.1 공식

$$ \text{Total Squares} = \sum\_{k=1}^{n} k^2 = 1^2 + 2^2 + \dots + n^2 $$
$$ = \frac{n(n+1)(2n+1)}{6} $$

### 2.2 원리

한 변의 길이가 $k$인 정사각형 ($1 \le k \le n$)의 개수를 셉니다.

- $1 \times 1$: $n \times n = n^2$개
- $2 \times 2$: $(n-1) \times (n-1) = (n-1)^2$개
- ...
- $k \times k$: $(n-k+1) \times (n-k+1)$개
- $n \times n$: $1 \times 1 = 1^2$개

## 3. 직사각형 격자 ($m \times n$ Grid)

가로 칸 수($n$)와 세로 칸 수($m$)가 다른 경우입니다. (일반성을 잃지 않고 $m \le n$이라 가정)

### 3.1 공식

$$ \text{Total Squares} = \sum\_{k=1}^{m} (m-k+1)(n-k+1) $$

### 3.2 원리

한 변의 길이가 $k$인 정사각형이 존재하려면 $k$는 짧은 변의 길이($m$)보다 클 수 없습니다.

- $k \times k$ 정사각형의 개수:
  - 세로로 가능한 위치: $m - k + 1$
  - 가로로 가능한 위치: $n - k + 1$
  - 개수: $(m-k+1) \times (n-k+1)$

## 4. 예제 (Examples)

### 예제 1: 체스판 ($8 \times 8$)

$8 \times 8$ 체스판에 있는 모든 정사각형의 개수는?
$$ 1^2 + 2^2 + \dots + 8^2 = \frac{8(9)(17)}{6} = 12 \times 17 = 204 \text{개} $$

### 예제 2: 직사각형 격자 ($3 \times 5$)

세로 3칸, 가로 5칸인 격자에서 정사각형의 개수는?

- $1 \times 1$: $3 \times 5 = 15$
- $2 \times 2$: $2 \times 4 = 8$
- $3 \times 3$: $1 \times 3 = 3$
- **총합:** $15 + 8 + 3 = 26 \text{개}$

## 5. 코드 구현 (Code Implementation)

Python을 사용하여 임의의 $m \times n$ 격자에서 정사각형 개수를 계산하는 함수입니다.

```python
def count_squares_in_rectangle(m, n):
    """
    m x n 격자(Grid)에 있는 모든 정사각형의 개수를 계산합니다.
    """
    # m을 더 작은 쪽으로 설정
    if m > n:
        m, n = n, m

    total_squares = 0
    # k는 정사각형의 한 변의 길이 (1부터 m까지)
    for k in range(1, m + 1):
        # 세로로 가능한 위치 * 가로로 가능한 위치
        count = (m - k + 1) * (n - k + 1)
        total_squares += count

    return total_squares

# 테스트
print(f"4x4 격자: {count_squares_in_rectangle(4, 4)}") # 1^2 + ... + 4^2 = 30
print(f"8x8 체스판: {count_squares_in_rectangle(8, 8)}") # 204
print(f"3x5 격자: {count_squares_in_rectangle(3, 5)}") # 15 + 8 + 3 = 26
```

## 6. 요약 (Summary)

- **정사각형 격자:** $\sum k^2 = \frac{n(n+1)(2n+1)}{6}$
- **직사각형 격자:** 크기별로 $(m-k+1)(n-k+1)$을 더한다.
- **팁:** $1 \times 1$ 개수부터 시작해서 가로, 세로 개수를 1씩 줄여가며 곱하고 더하면 된다. (예: $3 \times 5 \rightarrow 2 \times 4 \rightarrow 1 \times 3$)
