# 9.5 실전 문제 (Practice Problems)

## 1. 개요 (Overview)

이 장에서는 9.1장부터 9.4장까지 학습한 기하학적 개수 세기(Geometric Counting)의 모든 개념을 종합하여 실전 문제를 해결합니다. 단순한 공식 적용을 넘어, **특정 조건을 만족하는 도형**이나 **복합적인 경로** 문제를 해결하는 논리적 사고력을 배양합니다.

## 2. 주요 문제 유형 (Key Problem Types)

1.  **조건부 직사각형:** 격자 내에서 특정 칸(Cell)을 반드시 포함하는 직사각형의 개수.
2.  **경유 경로 (Path via Point):** A에서 B로 갈 때 반드시 특정 지점 P를 거쳐가는 최단 경로의 수.
3.  **격자 점 삼각형:** 격자판 위의 점들을 연결하여 만들 수 있는 삼각형의 개수 (일직선 제외 처리).
4.  **복잡한 도형 세기:** 규칙적인 격자가 아닌 도형에서 삼각형이나 사각형 개수 세기.

## 3. 예제 문제 및 풀이 (Sample Problems & Solutions)

### 문제 1: 특정 칸을 포함하는 직사각형

$4 \times 4$ 격자에서, 위에서 2번째, 왼쪽에서 2번째에 있는 칸(행2, 열2)을 **반드시 포함하는** 직사각형의 개수는?

- **원리:** 해당 칸을 포함하려면, 직사각형의
  - **위쪽 변:** 해당 칸의 위쪽(또는 같은 줄)에 있어야 함. (2가지: 1행, 2행)
  - **아래쪽 변:** 해당 칸의 아래쪽(또는 같은 줄)에 있어야 함. (3가지: 2행, 3행, 4행)
  - **왼쪽 변:** 해당 칸의 왼쪽(또는 같은 줄)에 있어야 함. (2가지: 1열, 2열)
  - **오른쪽 변:** 해당 칸의 오른쪽(또는 같은 줄)에 있어야 함. (3가지: 2열, 3열, 4열)
- **계산:** $(2 \times 3) \times (2 \times 3) = 6 \times 6 = 36$개.

### 문제 2: 경유지가 있는 최단 경로

가로 5칸, 세로 4칸인 격자에서 A(0,0)에서 B(5,4)로 갈 때, 반드시 점 P(2,2)를 **지나는** 최단 경로의 수는?

- **전략:** (A $\rightarrow$ P) 경로 수 $\times$ (P $\rightarrow$ B) 경로 수
- **A $\rightarrow$ P (2칸, 2칸):** $\binom{2+2}{2} = \binom{4}{2} = 6$
- **P $\rightarrow$ B (3칸, 2칸):** $\binom{3+2}{2} = \binom{5}{2} = 10$
- **정답:** $6 \times 10 = 60$

### 문제 3: 격자 점으로 삼각형 만들기

$3 \times 3$ 점 격자(총 9개의 점)에서 3개의 점을 선택하여 만들 수 있는 삼각형의 개수는?

- **전체 경우:** $\binom{9}{3} = \frac{9 \times 8 \times 7}{3 \times 2 \times 1} = 84$
- **일직선 제외 (Collinear):** 3점이 일직선 위에 있으면 삼각형이 안 됨.
  - 가로 3줄, 세로 3줄, 대각선 2줄 $\rightarrow$ 총 8개 줄.
  - 각 줄에서 3점을 뽑는 경우: $\binom{3}{3} = 1$.
  - 제외할 개수: $8 \times 1 = 8$.
- **정답:** $84 - 8 = 76$

## 4. 문제 해결 전략 (Problem Solving Strategies)

- **곱의 법칙 (Multiplication Rule):** "반드시 포함"하거나 "반드시 경유"하는 문제는 구간을 나누어 각각의 경우의 수를 곱합니다.
- **여사건 (Complementary Counting):** 삼각형 문제처럼 "만들 수 없는 경우(일직선)"를 전체에서 빼는 것이 효율적입니다.
- **좌표 설정:** 격자 문제는 좌표 평면으로 옮겨 생각하면($x, y$ 좌표) 계산이 명확해집니다.

## 5. 코드 구현 (Code Implementation)

Python을 사용하여 특정 칸 포함 직사각형 문제와 격자 점 삼각형 문제를 검증합니다.

```python
import math
from itertools import combinations

def count_rectangles_containing_cell(rows, cols, target_r, target_c):
    """
    rows x cols 격자에서 (target_r, target_c) 칸을 포함하는 직사각형 개수
    좌표는 1-based index 사용 (1 <= target_r <= rows)
    """
    # 위쪽 변 선택지: 1 ~ target_r (target_r개)
    # 아래쪽 변 선택지: target_r ~ rows (rows - target_r + 1개)
    # 왼쪽 변 선택지: 1 ~ target_c (target_c개)
    # 오른쪽 변 선택지: target_c ~ cols (cols - target_c + 1개)

    vertical_choices = target_r * (rows - target_r + 1)
    horizontal_choices = target_c * (cols - target_c + 1)

    return vertical_choices * horizontal_choices

def count_triangles_on_3x3_grid():
    # 3x3 점 격자 좌표 생성 (0,0) ~ (2,2)
    points = [(x, y) for x in range(3) for y in range(3)]
    total_combinations = list(combinations(points, 3))

    valid_triangles = 0
    for p1, p2, p3 in total_combinations:
        # 세 점이 일직선인지 확인 (기울기 비교)
        # (y2-y1)/(x2-x1) == (y3-y2)/(x3-x2) => (y2-y1)*(x3-x2) == (y3-y2)*(x2-x1)
        if (p2[1] - p1[1]) * (p3[0] - p2[0]) == (p3[1] - p2[1]) * (p2[0] - p1[0]):
            continue # 일직선임
        valid_triangles += 1

    return valid_triangles

print(f"문제 1 정답: {count_rectangles_containing_cell(4, 4, 2, 2)}") # Expected: 36
print(f"문제 3 정답: {count_triangles_on_3x3_grid()}") # Expected: 76
```

## 6. 요약 (Summary)

- **포함하는 직사각형:** $r \times (R-r+1) \times c \times (C-c+1)$.
- **경유 경로:** $A \to P$ 경로 수 $\times$ $P \to B$ 경로 수.
- **삼각형:** 전체 조합 $\binom{n}{3}$에서 일직선상의 점 조합을 뺀다.
