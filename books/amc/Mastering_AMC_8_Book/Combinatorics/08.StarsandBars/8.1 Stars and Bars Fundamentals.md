# 8.1 중복 조합의 기초 (Stars and Bars Fundamentals)

## 1. 개요 (Overview)

"Stars and Bars(별과 막대기)"는 조합론에서 **구별되지 않는(Indistinguishable)** 대상을 **구별되는(Distinguishable)** 상자에 나누어 담는 경우의 수를 세는 강력한 도구입니다. 이를 **중복 조합(Combinations with Repetition)**이라고도 부르며, $H$ 기호를 사용하여 $_nH_r$로 표기하기도 합니다.

## 2. 정리 1: 음이 아닌 정수해 (Non-negative Integers)

가장 기본적인 형태로, 빈 상자가 허용되는(0개를 받는 사람이 있어도 되는) 경우입니다.

### 2.1 개념

$n$개의 물건(Stars, $\star$)과 $k$개의 상자를 구분하기 위한 $k-1$개의 칸막이(Bars, $|$)를 일렬로 나열하는 순열의 수와 같습니다.

### 2.2 공식

$$ \binom{n + k - 1}{k - 1} = \binom{n + k - 1}{n} $$

- **방정식 모델:** $x_1 + x_2 + \dots + x_k = n$ ($x_i \ge 0$)
- $n$: 나누어 줄 물건의 개수
- $k$: 받을 대상(상자)의 수

## 3. 정리 2: 양의 정수해 (Positive Integers)

모든 상자에 **적어도 하나씩**은 들어가야 하는 경우입니다.

### 3.1 개념

$n$개의 물건을 일렬로 놓고, 물건들 사이의 $n-1$개의 틈새(Gap) 중 $k-1$곳을 골라 막대기를 놓는 것과 같습니다.
또는, 미리 $k$개의 상자에 하나씩 나누어 주고 남은 $n-k$개를 정리 1의 방법으로 나누어 주는 것으로 생각할 수도 있습니다.

### 3.2 공식

$$ \binom{n - 1}{k - 1} $$

- **방정식 모델:** $x_1 + x_2 + \dots + x_k = n$ ($x_i \ge 1$)

## 4. 예제 (Examples)

### 예제 1: 사탕 나누기 (빈 손 허용)

똑같은 사탕 7개를 3명의 아이(A, B, C)에게 나누어 주는 방법의 수?

- $n=7$ (사탕), $k=3$ (아이)
- 공식 적용: $\binom{7 + 3 - 1}{3 - 1} = \binom{9}{2}$
- 계산: $\frac{9 \times 8}{2 \times 1} = 36$가지

### 예제 2: 사탕 나누기 (적어도 하나씩)

똑같은 사탕 7개를 3명의 아이에게 **적어도 하나씩** 주는 방법의 수?

- $n=7, k=3$
- 공식 적용: $\binom{7 - 1}{3 - 1} = \binom{6}{2}$
- 계산: $\frac{6 \times 5}{2 \times 1} = 15$가지

## 5. 코드 구현 (Code Implementation)

Python을 사용하여 중복 조합 공식을 계산하고, 실제로 경우의 수를 생성하여 검증하는 코드입니다.

```python
import math
from itertools import combinations_with_replacement

def stars_and_bars(n, k, min_val=0):
    """
    n: 아이템 개수
    k: 그룹(상자) 개수
    min_val: 각 그룹당 최소 개수 (0 또는 1)
    """
    if min_val == 0:
        # 정리 1: x_i >= 0
        return math.comb(n + k - 1, k - 1)
    elif min_val > 0:
        # 정리 2: x_i >= 1 (미리 하나씩 나눠줌)
        remaining_n = n - (k * min_val)
        if remaining_n < 0:
            return 0
        return math.comb(remaining_n + k - 1, k - 1)

# 검증
n = 7
k = 3

print(f"사탕 7개, 아이 3명 (>=0): {stars_and_bars(n, k, 0)}") # Expected: 36
print(f"사탕 7개, 아이 3명 (>=1): {stars_and_bars(n, k, 1)}") # Expected: 15

# itertools를 이용한 검증 (>=0 인 경우)
# combinations_with_replacement는 n개 종류에서 중복 허용하여 k개를 뽑는 것과 동치
# Stars and Bars와 매핑하려면 관점을 바꿔야 하므로, 직접적인 개수 비교만 수행
```

## 6. 요약 (Summary)

- **구별되지 않는 물건**을 **구별되는 상자**에 넣을 때 사용합니다.
- **빈 상자 허용:** $\binom{n+k-1}{k-1}$ (별과 막대기 나열)
- **빈 상자 불가:** $\binom{n-1}{k-1}$ (틈새에 막대기 끼우기)
