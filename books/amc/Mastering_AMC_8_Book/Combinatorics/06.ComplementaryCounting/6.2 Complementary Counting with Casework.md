# 6.2 여사건과 케이스 분류 (Complementary Counting with Casework)

## 1. 개요 (Overview)

여사건(Complementary Counting) 전략을 사용할 때, 우리가 구하려는 반대 사건(Unwanted cases)이 단 한 번의 계산으로 구해지지 않는 경우가 있습니다. 이때 반대 사건을 다시 여러 개의 **케이스로 분류(Casework)**하여 계산한 뒤, 전체에서 빼는 복합적인 전략이 필요합니다. 이는 AMC 8 고난도 문제에서 자주 등장하는 패턴입니다.

## 2. 전략 프로세스 (Strategy Process)

1.  **여사건 결정:** "적어도", "초과/미만" 등의 키워드를 보고 전체에서 반대를 빼는 것이 유리하다고 판단합니다.
2.  **반대 사건 분석:** 반대되는 상황이 단일 조건이 아니라 복잡한 경우, 이를 겹치지 않는 케이스로 나눕니다.
3.  **케이스별 계산:** 각 반대 케이스의 경우의 수를 구하여 합산합니다.
4.  **최종 계산:** $\text{Target} = \text{Total} - (\text{Case 1} + \text{Case 2} + \dots)$

## 3. 예제 (Examples)

### 예제 1: 주사위의 합 (Sum of Dice)

서로 다른 주사위 3개를 던질 때, 눈의 합이 **5 이상**일 경우의 수는?

- **전체 경우:** $6 \times 6 \times 6 = 216$
- **반대 사건:** 눈의 합이 5 미만 (즉, 4 이하)인 경우.
  - 가능한 합은 3 또는 4입니다. (주사위 최소 눈은 1이므로 합은 3부터 시작)
- **Case 1 (합이 3):**
  - (1, 1, 1) $\rightarrow$ 1가지
- **Case 2 (합이 4):**
  - (1, 1, 2), (1, 2, 1), (2, 1, 1) $\rightarrow$ 3가지
- **계산:**
  $$ 216 - (1 + 3) = 216 - 4 = 212 $$

### 예제 2: 4의 배수 곱 (Product Divisible by 4)

집합 $\{1, 2, 3, \dots, 10\}$에서 서로 다른 3개의 수를 뽑을 때, 세 수의 곱이 **4의 배수**가 될 경우의 수는?

- **전체 경우:** $\binom{10}{3} = \frac{10 \times 9 \times 8}{3 \times 2 \times 1} = 120$
- **반대 사건:** 곱이 4의 배수가 **아닌** 경우.
  - 곱이 4의 배수가 아니려면, 소인수분해 했을 때 2의 개수가 0개 또는 1개여야 합니다.
  - **수 분류:**
    - 4의 배수 (2가 2개 이상): $\{4, 8\}$ (2개) $\rightarrow$ 뽑으면 무조건 4의 배수가 됨 (피해야 함).
    - 2의 배수지만 4의 배수 아님 (2가 1개): $\{2, 6, 10\}$ (3개).
    - 홀수 (2가 0개): $\{1, 3, 5, 7, 9\}$ (5개).
- **Case 1 (2가 0개):** 모두 홀수에서만 뽑는 경우.
  - $\binom{5}{3} = 10$
- **Case 2 (2가 1개):** $\{2, 6, 10\}$ 중 1개, 홀수 중 2개 뽑는 경우.
  - $\binom{3}{1} \times \binom{5}{2} = 3 \times 10 = 30$
- **계산:**
  $$ 120 - (10 + 30) = 120 - 40 = 80 $$

## 4. 코드 구현 (Code Implementation)

Python을 사용하여 예제 2(곱이 4의 배수)를 검증하는 코드입니다.

```python
from itertools import combinations

def solve_product_divisible_by_4():
    numbers = list(range(1, 11)) # 1 to 10
    total_combinations = list(combinations(numbers, 3))

    # 직접 세기 (Target)
    count_target = 0
    for comb in total_combinations:
        product = comb[0] * comb[1] * comb[2]
        if product % 4 == 0:
            count_target += 1

    # 여사건으로 세기 (Complementary)
    # 4의 배수가 아닌 경우: 2의 인수가 0개 또는 1개
    count_unwanted = 0
    for comb in total_combinations:
        product = comb[0] * comb[1] * comb[2]
        if product % 4 != 0:
            count_unwanted += 1

    total_count = len(total_combinations)

    print(f"전체 경우: {total_count}")          # 120
    print(f"직접 계산(4의 배수): {count_target}") # 80
    print(f"여사건 계산(4의 배수 아님): {count_unwanted}") # 40
    print(f"검증: {total_count} - {count_unwanted} = {total_count - count_unwanted}")

solve_product_divisible_by_4()
```

## 5. 요약 (Summary)

- **복합 전략:** 여사건을 쓴다고 해서 계산이 한 번에 끝나지 않을 수 있습니다. 반대 사건 내부에서 다시 케이스를 나누는 것을 두려워하지 마세요.
- **수 분류:** 배수 문제에서는 수들을 성질(홀수, 2의 배수, 4의 배수 등)에 따라 그룹화하는 것이 중요합니다.
- **검산:** "전체 - 반대" 논리가 맞는지, 반대 케이스를 빠짐없이 셌는지 확인해야 합니다.
