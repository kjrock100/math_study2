# 4.3.3 Higher Degree Polynomials 분석

이 문서는 **4.3.3 Higher Degree Polynomials** 섹션의 내용을 분석하고 설명합니다. 이 섹션은 차분법(method of finite differences)을 통해 수열이 2차 이상의 다항식임을 알아낸 후, 그 수열의 정확한 **닫힌 공식(closed formula)**을 찾는 구체적인 방법을 다룹니다.

## 1. 섹션 개요 (Overview)

앞선 섹션에서 우리는 수열의 차분을 반복적으로 구하여 $k$번째 차분이 상수가 되면, 그 수열이 $k$차 다항식임을 식별하는 법을 배웠습니다. 이제 남은 과제는 그 다항식의 계수들을 결정하여 $a_n = an^k + bn^{k-1} + \dots$ 형태의 완전한 공식을 찾아내는 것입니다.

## 2. 핵심 전략: 연립방정식 (System of Equations)

닫힌 공식을 찾는 가장 일반적인 방법은 **연립방정식을 이용하는 것**입니다.

1. **차수 결정:** 차분법을 사용하여 수열이 $k$차 다항식임을 확인합니다.
2. **일반식 가정:** 수열의 닫힌 공식을 $a_n = c_k n^k + c_{k-1} n^{k-1} + \dots + c_1 n + c_0$ 와 같이 미지의 계수($c_i$)를 포함한 $k$차 다항식으로 가정합니다.
3. **방정식 생성:** 수열의 초기 항들($a_0, a_1, \dots, a_k$)을 일반식에 대입하여 계수에 대한 $k+1$개의 선형 방정식을 만듭니다.
4. **방정식 풀이:** 생성된 연립방정식을 풀어 모든 계수($c_i$)의 값을 구합니다.

## 3. 예시: 2차 다항 수열의 공식 찾기

수열 $a_n: 2, 5, 11, 20, 32, \dots$ 의 닫힌 공식을 찾아봅시다.

1. **차분 분석:**
    * $\Delta a_n: 3, 6, 9, 12, \dots$ (등차수열)
    * $\Delta^2 a_n: 3, 3, 3, \dots$ (상수)
    * 2차 차분이 상수이므로, 이 수열은 2차 다항식입니다.

2. **일반식 가정:**
    * $a_n = an^2 + bn + c$

3. **방정식 생성 (인덱스를 $n=0$부터 시작):**
    * $n=0: a(0)^2 + b(0) + c = a_0 = 2 \implies c = 2$
    * $n=1: a(1)^2 + b(1) + c = a_1 = 5 \implies a + b + c = 5$
    * $n=2: a(2)^2 + b(2) + c = a_2 = 11 \implies 4a + 2b + c = 11$

4. **방정식 풀이:**
    * $c=2$를 대입하면:
        * $a + b = 3$
        * $4a + 2b = 9$
    * 첫 번째 식의 양변에 2를 곱하면 $2a + 2b = 6$.
    * 두 식을 빼면 $(4a+2b) - (2a+2b) = 9 - 6 \implies 2a = 3 \implies a = 3/2$.
    * $b = 3 - a = 3 - 3/2 = 3/2$.

5. **결론:**
    * 계수 $a=3/2, b=3/2, c=2$를 대입하여 닫힌 공식을 완성합니다.
    * $a_n = \frac{3}{2}n^2 + \frac{3}{2}n + 2$

## 4. 차분과 최고차항 계수의 관계

이 방법에는 유용한 지름길이 있습니다. $k$차 다항식의 $k$번째 차분 상수는 최고차항 계수 $c_k$와 $c_k \cdot k!$의 관계를 가집니다.

* **1차 (등차수열):** 1차 차분 상수 $d$는 최고차항 계수 $c_1$과 같습니다. ($d = c_1 \cdot 1!$)
* **2차:** 2차 차분 상수 $C$는 최고차항 계수 $c_2$와 $C = c_2 \cdot 2!$의 관계를 가집니다.
* 위 예시에서 2차 차분 상수는 3이므로, $3 = a \cdot 2! \implies a = 3/2$임을 바로 알 수 있어 연립방정식 풀이가 더 간단해집니다.

## 5. 요약

**4.3.3 Higher Degree Polynomials**는 수열 분석을 위한 체계적인 알고리즘을 제공합니다.

1. **차분법**으로 수열의 다항식 차수를 알아낸다.
2. 알아낸 차수에 맞는 **일반 다항식을 가정**한다.
3. 수열의 초기값들을 대입하여 **연립방정식을 세운다**.
4. 연립방정식을 풀어 **계수를 결정**하고 닫힌 공식을 완성한다.

이 과정을 통해 어떤 다항 수열이든 그 규칙을 명확한 공식으로 표현할 수 있습니다.
